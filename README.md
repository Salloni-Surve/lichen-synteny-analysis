# Comparative Genomics Pipeline for Fungal Synteny Analysis


### üß¨ Project Overview
This repository contains the end-to-end bioinformatics pipeline developed for my MSc Dissertation at the **University of Bristol**. The project investigated **gene synteny** (conserved gene order) across 38 fungal genomes to understand how evolutionary pressures shape genomic architecture.

**Key Finding:** Identified that ~48.65% of annotated genes are maintained in stable collinear blocks, specifically those involved in **protein biosynthesis** and **macromolecular metabolism**.


## ‚öôÔ∏è Prerequisites
Ensure the following software is installed and available in your PATH:
- **Python 3.7+**
- **R 4.0+** (Libraries: `ggplot2`, `dplyr`, `tidyr`, `stringr`, `TopGO`)
- **NCBI BLAST+**
- **BUSCO**
- **MCScanX**

  
## üíª Computational Resources & Environment
All computational analyses were performed using the **BluePebble High-Performance Computing (HPC) cluster** at the **University of Bristol‚Äôs Advanced Computing Research Centre (ACRC)**. The pipeline was developed and managed through a combination of local and remote environments:

**HPC Infrastructure:** Heavy computational tasks, including all-vs-all BLASTp and MCScanX runs, were executed on the BluePebble cluster.

**Workflow Automation:** Job scripts were customized using Python v2.7.15 to maintain compatibility with specific legacy bioinformatics tools hosted on the HPC.

**Data Analysis:** Statistical analysis and final visualizations were conducted using R v4.4.1 in an RStudio environment.


## üìã Implementation Guide

### 1. üß™ Data Pre-processing

The genomes used for my project were downloaded from the National Centre for Biotechnology Information (NCBI) database, which provides publicly available, standardised, and peer-reviewed assemblies widely used in fungal genomics research. The types of data required are `genomic.fna`, `protein.faa`, `cds_from_genomic.fna`. 

we begin with standardizing protein FASTA headers to ensure uniformity of raw data and compatibility with MCScanX.
```bash
python clean_headers.py input_protein_file.faa
```

### 2. üõ†Ô∏è Quality Control

Its important to ensure the completeness of all genomes used. For this task, Benchmarking of Universal Single-Copy Orthologs (BUSCO) v5.8.2 (52), applied in both genome (nucleotide) and proteome (protein) modes with the Ascomycota lineage dataset. The dataset and mode can be changed based of the users respective needs. 
```bash
run_busco_nuc.sh run_busco_prot.sh
```
**Input:** Cleaned protein files.

### 3. üîç Homology Detection
To identify homologous proteins across species, protein‚Äìprotein sequence comparisons were conducted using the Basic Local Alignment Search Tool for proteins (BLASTp), implemented in NCBI BLAST v2.16.0. This approach generates pairwise similarity data essential for ortholog 251 detection pipelines and is the recommended input for MCScanX.
```bash
python run_blast_pipeline.py
```
**Note:** This script will automatically create every possible species pair and merge the results into a `master.blast` file.

### 4. üß≠ Map Coordinates
Generate the GFF/Coordinate files MCScanX needs to understand gene locations.
```bash
python generate_mcscanx_coords.py ./cds_files ./species_map.txt ./output_gff
```
**Input:** the `*_cds_from_genomics.fna` files.

### 5. üî¨ Synteny Block Detection
Synteny block detection was performed using MCScanX. MCScanX is one of the most widely used and benchmarked tools for this purpose, providing accurate and scalable detection across diverse taxa. The pipeline was run with default parameters, which help identify collinear gene pairs based on input homology data and genome coordinates. The output generated by MCScanX included lists of collinear blocks, summary statistics on block size, and the percentage of genes assigned to these blocks. The protocols for this program are attached. 
```bash
run_mcscanx.sh
```
**Input:** the `master.blast` and `master.gff` files generated from earlier 2 steps.

### 6. üìä Visualization
To finish the project we check the results by generating a comparative heatmap of conserved gene counts.
```R
Rscript generate_heatmap.R
```
### 7. üåø Functional Enrichment (TopGO)
To understand the biological significance of the conserved gene blocks, I performed Gene Ontology (GO) enrichment analysis. This helps us understand the significance of the observed conserved blocks by telling us about their functions.
**Process:**
1. **Tool:** R/Bioconductor package `topGO`.
2. **Algorithm:** Utilized the **'elim' algorithm**, which decorrelates the GO graph to handle the hierarchical nature of Gene Ontology, providing more conservative and reliable p-values.
3. **Objective:** To determine if genes found within syntenic (collinear) blocks are enriched for specific functions compared to the rest of the genome.
4. **Execution:**
   ```R
   Rscript run_topgo_enrichment
   ```

## üåê General Applications & Extensibility
While this pipeline was optimized for lichen-forming fungi, its modular architecture allows it to be applied to any comparative genomics project involving eukaryotic or prokaryotic organisms:

**Pangenome Studies:** Use the BLAST and MCScanX modules to identify the "core" vs. "accessory" genome components in diverse species.

**Genome Stability Analysis:** Monitor chromosomal rearrangements or synteny conservation in industrial fermentation strains to ensure genetic consistency over time.

**Functional Cluster Identification:** Pair the coordinate generation and TopGO scripts to identify physically linked gene clusters involved in specific metabolic pathways.

**Quality Benchmarking:** The dual-level BUSCO assessment provides a standard template for verifying assembly and annotation quality in any newly sequenced genome.

## üîß Reproducibility Checklist
To use this pipeline on your own data:

**Format Input:** Ensure protein and CDS headers match and use consistent species prefixes.

**Mapping:** Create a species_map.txt linking your filenames to 4-letter codes.

**HPC Settings:** If running on a cluster (like BluePebble), update the #SBATCH directives in the shell scripts to match your local resources.

## üì¨ Contact & Collaboration
I am a **Bioinformatician** with a background in Data Engineering and a professional background in high-pressure project management. I am interested in applying genomic pipelines to solve complex problems in **FoodTech, Alternative Proteins, and Microbial Research**.

[Salloni Surve]

Email: [salsur012@gmail.com]

LinkedIn: [(https://www.linkedin.com/in/salloni-surve-0a5159242/)]

GitHub: [(https://github.com/Salloni-Surve/lichen-synteny-analysis)]
